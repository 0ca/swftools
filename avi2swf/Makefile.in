top_builddir = ..
srcdir = @srcdir@
top_srcdir = @top_srcdir@
include ../Makefile.common

VIDEO_LIBS=@VIDEO_LIBS@
VIDEO_CFLAGS=@VIDEO_CFLAGS@

all: avi2swf$(E)

videoreader_avifile.o: videoreader_avifile.cc videoreader_avifile.hh
	$(CC) $(VIDEO_CFLAGS) $< -o $@

videoreader_vfw.o: videoreader_vfw.cc videoreader_vfw.hh
	$(CC) $(VIDEO_CFLAGS) $< -o $@

avi2swf.o: avi2swf.cc videoreader_vfw.hh videoreader_avifile.hh
	$(CC) $< -o $@

v2swf.o: v2swf.c ../lib/q.h
	$(C) $< -o $@

avi2swf$(E): avi2swf.o v2swf.o videoreader_avifile.o videoreader_vfw.o ../lib/q.o
	$(LL) avi2swf.o v2swf.o videoreader_avifile.o videoreader_vfw.o ../lib/q.o -o avi2swf$(E) ../lib/librfxswf.a $(LIBS) $(VIDEO_LIBS)
	$(STRIP) avi2swf$(E)

install:
	$(mkinstalldirs) $(bindir)
	$(mkinstalldirs) $(man1dir)
	@file=avi2swf;$(INSTALL_BIN);$(INSTALL_MAN1)
	
uninstall:
	@file=avi2swf;$(UNINSTALL_BIN);$(UNINSTALL_MAN1)

clean: 
	rm -f *.o *.lo *.a *.la avi2swf gmon.out

doc:
	perl ../parsedoc.pl avi2swf.doc

.PHONY: all doc clean install uninstall
